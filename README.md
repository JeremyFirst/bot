# Discord-бот для управления администрированием RUST-сервера

Бот интегрируется с Discord и RCON-сервером RUST. Основные функции:

1. Отображение состава администрации (по ролям в Discord)
2. Выдача привилегий с проверкой через RCON, сохранением в БД и автоматическим снятием по окончании
3. Учёт выговоров и автоматическое снятие прав при достижении лимита

## Установка

### Локальная установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте файл конфигурации `config/config.yaml` на основе `.echod-example`

3. Создайте базу данных MariaDB/MySQL и выполните схему:
```bash
mysql -u rustbot_user -p rustbot < database/schema.sql
```

4. Запустите бота:
```bash
python src/bot.py
```

### Развертывание на Pterodactyl

См. подробную инструкцию в [DEPLOY.md](DEPLOY.md) или [QUICK_START.md](QUICK_START.md)

## Структура проекта

```
.
├── legacy/              # Старый код (WebRCON клиент)
├── src/
│   ├── bot.py          # Главный файл бота
│   ├── rcon/           # Модуль для работы с RCON
│   ├── database/       # Модуль для работы с БД
│   ├── commands/       # Команды бота (slash-commands)
│   ├── utils/          # Утилиты (парсеры, время, embed)
│   └── tasks/           # Планировщик задач
├── config/             # Конфигурация
├── database/           # Схемы БД
├── requirements.txt    # Зависимости
└── .env.example        # Пример конфигурации
```

## Команды

- `/showadmin [category]` - Отображает состав администрации
- `/addprivilege <steamid> [user]` - Выдаёт привилегию пользователю
- `/warn <user> <reason>` - Выдаёт выговор пользователю

## Конфигурация

Все настройки находятся в файле `.env`. См. `.env.example` для примера.

## Примечания

- Бот использует WebRCON (WebSocket) для подключения к RUST серверу
- Время конвертируется из UTC в MSK (UTC+3) при сохранении и отображении
- Автоматическое снятие прав происходит через планировщик задач
- Все действия логируются в файл и канал Discord

